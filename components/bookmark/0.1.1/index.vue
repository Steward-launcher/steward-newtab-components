<template>
  <a class="sp-bookmark" :href="bookmark.url">{{ bookmark.title }}
    <span class="icon-next" @click.stop="onNextClick">
      <svg t="1631860117164" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3075" xmlns:xlink="http://www.w3.org/1999/xlink" width="20px" height="20px"><defs><style type="text/css"></style></defs><path d="M998.518477 373.539106 606.691055 7.700309c0 0-9.626601-10.426819-18.518918-7.014151-13.025282 5.010108-9.190027 17.066337-9.190027 17.066337l0 199.232471c-384.624455-46.968141-532.994587 197.72794-564.303018 442.988469-24.048519 188.36608-10.217024 360.766749-10.217024 360.766749 127.372634-562.16011 571.141341-403.101414 571.141341-403.101414l0.074927 199.076623c0 0 2.887181 11.392876 11.967315 15.026328 10.020216 4.010085 18.603835-1.437596 18.603835-1.437596l396.398958-363.177396c12.840463-12.553743 20.85264-25.735872 20.85264-46.622478C1023.501084 400.465815 1010.726557 384.312587 998.518477 373.539106zM936.333194 448.561855 656.790138 707.063455c0 0-6.969195 9.018195-10.974285 7.014151-5.262861-2.60146-2.894174-8.015174-2.894174-8.015174L642.921679 570.798503c0 0-389.871332-148.291209-577.237389 165.318584 0 0 10.998261-224.436861 98.169148-327.637097 86.041989-101.88552 232.940558-158.308429 474.410788-122.239646l1.781261-159.309451c0 0-0.303703-8.234959 2.830237-9.017196 4.007088-1.003021 8.96125 4.007088 8.96125 4.007088l289.570265 277.54101c10.707545 9.424798 13.026281 15.059296 13.965364 26.049565C956.368631 437.539617 945.351389 439.54366 936.333194 448.561855z" p-id="3076" fill="currentColor"></path></svg>
    </span>
    <span class="icon-remove" @click.stop="onRemoveClick">
      <svg width="20px" height="20px" viewBox="0 0 56 56" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <title>Icons 56/delete_outline_56 iOS</title>
          <desc>Created with Sketch.</desc>
          <g id="Icons-56/delete_outline_56-iOS" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
              <g id="delete_outline_56-iOS">
                  <rect x="0" y="0" width="56" height="56"></rect>
                  <path d="M28,4 C32.0796344,4 35.4460359,7.05371356 35.9381123,11.0000487 L46.5,11 C47.3284271,11 48,11.6715729 48,12.5 C48,13.3284271 47.3284271,14 46.5,14 L43.78,14 L41.3514201,47.1972592 C41.2267013,48.9017483 41.0153786,49.5088222 40.6514364,50.1172712 C40.2874941,50.7257203 39.7811134,51.1964025 39.1477278,51.5149724 C38.5143421,51.8335423 37.8934654,52 36.1844196,52 L19.8155804,52 C18.1065346,52 17.4856579,51.8335423 16.8522722,51.5149724 C16.2188866,51.1964025 15.7125059,50.7257203 15.3485636,50.1172712 C14.9846214,49.5088222 14.7732987,48.9017483 14.6485799,47.1972592 L12.219,14 L9.5,14 C8.67157288,14 8,13.3284271 8,12.5 C8,11.6715729 8.67157288,11 9.5,11 L20.0618877,11.0000487 C20.5539641,7.05371356 23.9203656,4 28,4 Z M40.772,14 L15.227,14 L17.6405811,46.9783323 C17.7232154,48.1076674 17.784792,48.3459913 17.9231442,48.5772924 C17.9947333,48.6969771 18.0756735,48.7722112 18.2002634,48.8348754 C18.4259954,48.9484104 18.6529589,48.9941963 19.6134787,48.9994761 L36.1844196,49 C37.3167738,49 37.5589558,48.9559794 37.7997366,48.8348754 C37.9243265,48.7722112 38.0052667,48.6969771 38.0768558,48.5772924 C38.215208,48.3459913 38.2767846,48.1076674 38.3594189,46.9783323 L40.772,14 Z M28,20 C28.8284271,20 29.5,20.6715729 29.5,21.5 L29.5,21.5 L29.5,39.5 C29.5,40.3284271 28.8284271,41 28,41 C27.1715729,41 26.5,40.3284271 26.5,39.5 L26.5,39.5 L26.5,21.5 C26.5,20.6715729 27.1715729,20 28,20 Z M34.9385865,20.0011523 L35.083205,20.0023095 C35.9103567,20.0482623 36.5436434,20.7560534 36.4976905,21.583205 L36.4976905,21.583205 L35.4976905,39.583205 C35.4517377,40.4103567 34.7439466,41.0436434 33.916795,40.9976905 C33.0896433,40.9517377 32.4563566,40.2439466 32.5023095,39.416795 L32.5023095,39.416795 L33.5023095,21.416795 C33.5482623,20.5896433 34.2560534,19.9563566 35.083205,20.0023095 Z M20.916795,20.0023095 C21.7439466,19.9563566 22.4517377,20.5896433 22.4976905,21.416795 L22.4976905,21.416795 L23.4976905,39.416795 C23.5436434,40.2439466 22.9103567,40.9517377 22.083205,40.9976905 C21.2560534,41.0436434 20.5482623,40.4103567 20.5023095,39.583205 L20.5023095,39.583205 L19.5023095,21.583205 C19.4563566,20.7560534 20.0896433,20.0482623 20.916795,20.0023095 Z M28,7 C25.5810421,7 23.5632884,8.71775968 23.1000181,11 L32.8999819,11 C32.4367116,8.71775968 30.4189579,7 28,7 Z" id="â†³-Icon-Color" fill="currentColor" fill-rule="nonzero"></path>
              </g>
          </g>
      </svg>
    </span>
  </a>
</template>

<script>
module.exports = {
  name: 'Bookmarks',
  data() {
    return {
      bookmark: {
        url: '',
        title: ''
      }
    }
  },

  methods: {
    async getOneBookmark() {
      const list = await window.stewardApp.browser.bookmarks.getRecent(2147483647)

      if (list && list.length) {
        return list[Math.floor(Math.random(list.length) * list.length)]
      } else {
        return
      }
    },

    async random() {
      const item = await this.getOneBookmark()

      if (item) {
        this.bookmark = item
      }
    },

    async onRemoveClick(event) {
      event.stopPropagation();
      event.preventDefault();
      await window.stewardApp.browser.bookmarks.remove(this.bookmark.id)
      this.random()
    },

    onNextClick(event) {
      event.stopPropagation();
      event.preventDefault();
      this.random()
    }
  },

  mounted() {
    this.random()
  }
}
</script>

<style>
  .sp-bookmark {
    position: absolute;
    background: rgba(0, 0, 0, .3);
    padding: 10px;
    bottom: 0;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    width: 100%;
    overflow: hidden;
    text-align: center;
    text-overflow: ellipsis;
    white-space: nowrap;
    text-decoration: none;
    color: #ddd;
  }

  .sp-bookmark:hover .icon-remove, .sp-bookmark:hover .icon-next {
    opacity: 1;
  }

  .icon-next, .icon-remove {
    position: absolute;
    opacity: 0;
    transition: all 200ms ease-in;
  }

  .icon-remove {
    left: 20px;
  }

  .icon-next {
    right: 20px;
  }
</style>